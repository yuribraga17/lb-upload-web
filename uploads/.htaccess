# .htaccess para pasta uploads/ - Com Revalidação
# Coloque este arquivo em: uploads/.htaccess

<IfModule mod_headers.c>
    # Cache de 1 semana com revalidação para imagens
    <FilesMatch "\.(jpg|jpeg|png|gif|webp|ico|svg)$">
        Header set Cache-Control "public, max-age=604800, must-revalidate"
        Header append Vary "Accept-Encoding"
    </FilesMatch>

    # Cache de 1 semana com revalidação para vídeos
    <FilesMatch "\.(mp4|webm|mov|avi)$">
        Header set Cache-Control "public, max-age=604800, must-revalidate"
        Header append Vary "Accept-Encoding"
    </FilesMatch>

    # Cache de 1 semana com revalidação para áudios
    <FilesMatch "\.(mp3|wav|ogg|aac|webm)$">
        Header set Cache-Control "public, max-age=604800, must-revalidate"
        Header append Vary "Accept-Encoding"
    </FilesMatch>

    # Headers de segurança
    Header set X-Content-Type-Options "nosniff"
    Header set X-Frame-Options "SAMEORIGIN"
    Header set X-XSS-Protection "1; mode=block"

    # CORS - Permitir acesso de qualquer origem
    Header set Access-Control-Allow-Origin "*"
    Header set Access-Control-Allow-Methods "GET, OPTIONS"
    Header set Access-Control-Allow-Headers "Content-Type"
    
    # ETag para melhor controle de cache
    Header set ETag "%{REQUEST_TIME}x-%{REQUEST_URI}x"
</IfModule>

# Compressão GZIP
<IfModule mod_deflate.c>
    AddOutputFilterByType DEFLATE text/plain
    AddOutputFilterByType DEFLATE text/html
    AddOutputFilterByType DEFLATE text/xml
    AddOutputFilterByType DEFLATE text/css
    AddOutputFilterByType DEFLATE application/xml
    AddOutputFilterByType DEFLATE application/xhtml+xml
    AddOutputFilterByType DEFLATE application/rss+xml
    AddOutputFilterByType DEFLATE application/javascript
    AddOutputFilterByType DEFLATE application/x-javascript
</IfModule>

# Configurações de MIME type
<IfModule mod_mime.c>
    # Imagens
    AddType image/jpeg jpg jpeg
    AddType image/png png
    AddType image/gif gif
    AddType image/webp webp
    AddType image/svg+xml svg svgz
    
    # Vídeos
    AddType video/mp4 mp4
    AddType video/webm webm
    AddType video/quicktime mov
    AddType video/x-msvideo avi
    
    # Áudios
    AddType audio/mpeg mp3
    AddType audio/wav wav
    AddType audio/ogg ogg
    AddType audio/aac aac
    AddType audio/webm weba
</IfModule>

# Desabilitar listagem de diretórios
Options -Indexes